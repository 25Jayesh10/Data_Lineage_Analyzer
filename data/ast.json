[
  {
    "proc_name": "log_hr_employees",
    "params": [],
    "return_type": "VOID",
    "variables": [
      { "name": "@emp_id", "type": "INT" },
      { "name": "@emp_name", "type": "VARCHAR(100)" }
    ],
    "statements": [
      {
        "type": "DECLARE_CURSOR",
        "cursor_name": "emp_cursor",
        "query": "SELECT emp_id, emp_name FROM employees WHERE department = 'HR'"
      },
      {
        "type": "OPEN_CURSOR",
        "cursor_name": "emp_cursor"
      },
      {
        "type": "FETCH_CURSOR",
        "cursor_name": "emp_cursor",
        "fetch_into": ["@emp_id", "@emp_name"]
      },
      {
        "type": "WHILE",
        "condition": "@@sqlstatus = 0",
        "body": [
          {
            "type": "EXECUTE_PROCEDURE",
            "procedure": "INSERT INTO employee_log (emp_id, emp_name, log_time) VALUES (@emp_id, @emp_name, GETDATE())",
            "args": []
          },
          {
            "type": "FETCH_CURSOR",
            "cursor_name": "emp_cursor",
            "fetch_into": ["@emp_id", "@emp_name"]
          }
        ]
      },
      {
        "type": "CLOSE_CURSOR",
        "cursor_name": "emp_cursor"
      },
      {
        "type": "DEALLOCATE_CURSOR",
        "cursor_name": "emp_cursor"
      }
    ]
  }
]
