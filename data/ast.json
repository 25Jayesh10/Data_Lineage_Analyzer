[
  {
    "proc_name": "archive_inactive_users",
    "params": [],
    "return_type": "VOID",
    "variables": [
      {
        "name": "@user_id",
        "type": "INT"
      }
    ],
    "statements": [
      {
        "type": "SELECT_INTO",
        "query": "SELECT TOP 1 @user_id = user_id FROM users WHERE active = 0"
      },
      {
        "type": "IF",
        "condition": "@user_id IS NOT NULL",
        "then": [
          {
            "type": "SELECT_INTO",
            "query": "INSERT INTO archived_users (user_id, archived_at) VALUES (@user_id, GETDATE())"
          }
        ]
      }
    ]
  }
]
