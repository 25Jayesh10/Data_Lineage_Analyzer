[
  {
    "proc_name": "log_high_salary_employees",
    "params": [
      {
        "name": "@threshold_salary",
        "type": "INT",
        "mode": "IN"
      }
    ],
    "return_type": "void",
    "variables": [
      { "name": "@emp_id", "type": "INT" },
      { "name": "@emp_name", "type": "VARCHAR(100)" },
      { "name": "@emp_salary", "type": "INT" }
    ],
    "statements": [
      {
        "type": "DECLARE_CURSOR",
        "cursor_name": "emp_cursor",
        "query": "SELECT emp_id, emp_name, salary FROM employees WHERE salary > @threshold_salary"
      },
      {
        "type": "OPEN_CURSOR",
        "cursor_name": "emp_cursor"
      },
      {
        "type": "FETCH_CURSOR",
        "cursor_name": "emp_cursor",
        "fetch_into": ["@emp_id", "@emp_name", "@emp_salary"]
      },
      {
        "type": "WHILE",
        "condition": "@@SQLSTATUS = 0",
        "body": [
          {
            "type": "INSERT_INTO",
            "table": "high_salary_log",
            "columns": ["emp_id", "emp_name", "salary", "log_date"],
            "values": ["@emp_id", "@emp_name", "@emp_salary", "GETDATE()"]
          },
          {
            "type": "FETCH_CURSOR",
            "cursor_name": "emp_cursor",
            "fetch_into": ["@emp_id", "@emp_name", "@emp_salary"]
          }
        ]
      },
      {
        "type": "CLOSE_CURSOR",
        "cursor_name": "emp_cursor"
      },
      {
        "type": "DEALLOCATE_CURSOR",
        "cursor_name": "emp_cursor"
      }
    ]
  }
]
