[
  {
    "proc_name": "archive_inactive_users",
    "params": [],
    "return_type": "void",
    "variables": [
      {
        "name": "@user_id",
        "type": "INT"
      }
    ],
    "statements": [
      {
        "type": "SELECT_INTO",
        "query": "SELECT TOP 1 @user_id = user_id FROM users WHERE active = 0"
      },
      {
        "type": "IF",
        "condition": "@user_id IS NOT NULL",
        "then": [
          {
            "type": "INSERT",
            "table": "archived_users",
            "columns": ["user_id", "archived_at"],
            "values": ["@user_id", "GETDATE()"]
          }
        ]
      }
    ]
  }
]
